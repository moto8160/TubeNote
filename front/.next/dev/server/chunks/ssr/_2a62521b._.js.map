{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/WORK/youtube-post/front/src/features/videos/video.server.ts"],"sourcesContent":["'use server';\r\nimport { YoutubeOEmbedResponse } from '../videos/video.type';\r\n\r\nexport async function fetchVideos() {\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/videos`);\r\n\r\n  if (!res.ok) {\r\n    throw new Error('Failed to fetch videos');\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\nexport default async function fetchVideoDetail(videoId: string) {\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/videos/${videoId}`);\r\n  const json = await res.json();\r\n\r\n  if (!res.ok) {\r\n    throw new Error(json.message ?? 'Failed to fetch video');\r\n  }\r\n\r\n  return json;\r\n}\r\n\r\nexport async function fetchOEmbed(videoUrl: string): Promise<YoutubeOEmbedResponse> {\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/videos/preview`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ videoUrl }),\r\n  });\r\n  const json = await res.json();\r\n\r\n  if (!res.ok) {\r\n    throw new Error(json.message ?? 'Failed to fetch video Previw');\r\n  }\r\n\r\n  return json;\r\n}\r\n\r\n//postに移動したほうがいいきが\r\ntype SuccessResponse = { success: true };\r\n\r\nexport async function createPost(formData: FormData): Promise<SuccessResponse> {\r\n  const videoUrl = formData.get('url');\r\n  const text = formData.get('text');\r\n\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/posts`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ videoUrl, text }),\r\n  });\r\n\r\n  const json = await res.json();\r\n\r\n  if (!res.ok) {\r\n    throw new Error(json.message);\r\n  }\r\n\r\n  return json;\r\n}\r\n"],"names":[],"mappings":";;;;;;;IA0CsB,aAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/WORK/youtube-post/front/src/features/videos/video.server.ts"],"sourcesContent":["'use server';\r\nimport { YoutubeOEmbedResponse } from '../videos/video.type';\r\n\r\nexport async function fetchVideos() {\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/videos`);\r\n\r\n  if (!res.ok) {\r\n    throw new Error('Failed to fetch videos');\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\nexport default async function fetchVideoDetail(videoId: string) {\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/videos/${videoId}`);\r\n  const json = await res.json();\r\n\r\n  if (!res.ok) {\r\n    throw new Error(json.message ?? 'Failed to fetch video');\r\n  }\r\n\r\n  return json;\r\n}\r\n\r\nexport async function fetchOEmbed(videoUrl: string): Promise<YoutubeOEmbedResponse> {\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/videos/preview`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ videoUrl }),\r\n  });\r\n  const json = await res.json();\r\n\r\n  if (!res.ok) {\r\n    throw new Error(json.message ?? 'Failed to fetch video Previw');\r\n  }\r\n\r\n  return json;\r\n}\r\n\r\n//postに移動したほうがいいきが\r\ntype SuccessResponse = { success: true };\r\n\r\nexport async function createPost(formData: FormData): Promise<SuccessResponse> {\r\n  const videoUrl = formData.get('url');\r\n  const text = formData.get('text');\r\n\r\n  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/posts`, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ videoUrl, text }),\r\n  });\r\n\r\n  const json = await res.json();\r\n\r\n  if (!res.ok) {\r\n    throw new Error(json.message);\r\n  }\r\n\r\n  return json;\r\n}\r\n"],"names":[],"mappings":";;;;;;;IAwBsB,cAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/WORK/youtube-post/front/src/app/posts/create/page.tsx"],"sourcesContent":["'use client';\r\nimport { createPost, fetchOEmbed } from '@/features/videos/video.server';\r\nimport { YoutubeOEmbedResponse } from '@/features/videos/video.type';\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport default function PostsPage() {\r\n  const [url, setUrl] = useState('');\r\n  const [text, setText] = useState('');\r\n  const [video, setVideo] = useState<YoutubeOEmbedResponse | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // URL入力が変わる毎にフェッチ（500msでデバウンス）\r\n  useEffect(() => {\r\n    // コールバック関数;\r\n    if (!url) return;\r\n    \r\n    const timer = setTimeout(async () => {\r\n      try {\r\n        const video = await fetchOEmbed(url);\r\n        setVideo(video);\r\n        setError(null);\r\n      } catch (e) {\r\n        if (e instanceof Error) {\r\n          setError(e.message);\r\n          setVideo(null);\r\n        } else {\r\n          setError('エラーが発生しました');\r\n        }\r\n      }\r\n    }, 500);\r\n\r\n    // クリーンアップ関数\r\n    return () => {\r\n      clearTimeout(timer);\r\n    };\r\n  }, [url]); //トリガー配列\r\n\r\n  const handleSubmit = async (formData: FormData) => {\r\n    try {\r\n      await createPost(formData);\r\n      setError('登録成功'); //後でリダイレクトに変更\r\n    } catch (e) {\r\n      if (e instanceof Error) {\r\n        setError(e.message);\r\n      } else {\r\n        setError('エラーが発生しました');\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto\">\r\n      <div>\r\n        <form action={handleSubmit} className=\"flex flex-col space-y-5\">\r\n          <input\r\n            name=\"url\"\r\n            value={url}\r\n            onChange={(e) => {\r\n              setUrl(e.target.value);\r\n            }}\r\n            className=\"bg-gray-300\"\r\n          ></input>\r\n          <input name=\"text\" className=\"bg-gray-300\" />\r\n          {video && (\r\n            <div>\r\n              <h2>{video.title}</h2>\r\n              <h2>{video.author_name}</h2>\r\n              <img src={video.thumbnail_url} />\r\n            </div>\r\n          )}\r\n          <button>投稿</button>\r\n        </form>\r\n      </div>\r\n      {error && <h2>{error}</h2>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AAAA;AAEA;AAHA;;;;AAKe,SAAS;IACtB,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAC;IAC/B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAA+B;IACjE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,+BAA+B;IAC/B,IAAA,kNAAS,EAAC;QACR,YAAY;QACZ,IAAI,CAAC,KAAK;QAEV,MAAM,QAAQ,WAAW;YACvB,IAAI;gBACF,MAAM,QAAQ,MAAM,IAAA,gLAAW,EAAC;gBAChC,SAAS;gBACT,SAAS;YACX,EAAE,OAAO,GAAG;gBACV,IAAI,aAAa,OAAO;oBACtB,SAAS,EAAE,OAAO;oBAClB,SAAS;gBACX,OAAO;oBACL,SAAS;gBACX;YACF;QACF,GAAG;QAEH,YAAY;QACZ,OAAO;YACL,aAAa;QACf;IACF,GAAG;QAAC;KAAI,GAAG,QAAQ;IAEnB,MAAM,eAAe,OAAO;QAC1B,IAAI;YACF,MAAM,IAAA,+KAAU,EAAC;YACjB,SAAS,SAAS,aAAa;QACjC,EAAE,OAAO,GAAG;YACV,IAAI,aAAa,OAAO;gBACtB,SAAS,EAAE,OAAO;YACpB,OAAO;gBACL,SAAS;YACX;QACF;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;0BACC,cAAA,8OAAC;oBAAK,QAAQ;oBAAc,WAAU;;sCACpC,8OAAC;4BACC,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC;gCACT,OAAO,EAAE,MAAM,CAAC,KAAK;4BACvB;4BACA,WAAU;;;;;;sCAEZ,8OAAC;4BAAM,MAAK;4BAAO,WAAU;;;;;;wBAC5B,uBACC,8OAAC;;8CACC,8OAAC;8CAAI,MAAM,KAAK;;;;;;8CAChB,8OAAC;8CAAI,MAAM,WAAW;;;;;;8CACtB,8OAAC;oCAAI,KAAK,MAAM,aAAa;;;;;;;;;;;;sCAGjC,8OAAC;sCAAO;;;;;;;;;;;;;;;;;YAGX,uBAAS,8OAAC;0BAAI;;;;;;;;;;;;AAGrB"}},
    {"offset": {"line": 175, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/WORK/youtube-post/front/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/WORK/youtube-post/front/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-client-wrapper.ts"],"sourcesContent":["// This file must be bundled in the app's client layer, it shouldn't be directly\n// imported by the server.\n\nexport { callServer } from 'next/dist/client/app-call-server'\nexport { findSourceMapURL } from 'next/dist/client/app-find-source-map-url'\n\n// A noop wrapper to let the Flight client create the server reference.\n// See also: https://github.com/facebook/react/pull/26632\n// eslint-disable-next-line import/no-extraneous-dependencies\nexport { createServerReference } from 'react-server-dom-webpack/client'\n"],"names":["callServer","createServerReference","findSourceMapURL"],"mappings":"AAAA,gFAAgF;AAChF,0BAA0B;;;;;;;;;;;;;;;;IAEjBA,UAAU,EAAA;eAAVA,eAAAA,UAAU;;IAMVC,qBAAqB,EAAA;eAArBA,QAAAA,qBAAqB;;IALrBC,gBAAgB,EAAA;eAAhBA,qBAAAA,gBAAgB;;;+BADE;qCACM;wBAKK","ignoreList":[0]}}]
}